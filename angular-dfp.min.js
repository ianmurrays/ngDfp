var googletag=googletag||{};googletag.cmd=googletag.cmd||[];
angular.module("ngDfp",[]).constant("ngDfpUrl","//www.googletagservices.com/tag/js/gpt.js").provider("DoubleClick",["ngDfpUrl",function(d){var c={},g={},e={},n=null,h=!0,k={},l=!1;this._createTag=function(a){if(h){var f=document.createElement("script"),m="https:"===document.location.protocol,b=document.getElementsByTagName("script")[0];f.async=!0;f.type="text/javascript";f.src=(m?"https:":"http:")+d;b.parentNode.insertBefore(f,b);f.onreadystatechange=function(){"complete"==this.readyState&&a()};f.onload=
a}};this._initialize=function(){var a=this;googletag.cmd.push(function(){angular.forEach(c,function(a,b){g[b]=googletag.defineSlot.apply(null,a).addService(googletag.pubads());e[b]&&g[b].defineSizeMapping(e[b])});angular.forEach(k,function(a,b){googletag.pubads().setTargeting(b,a)});l&&googletag.pubads().collapseEmptyDivs();googletag.pubads().enableSingleRequest();googletag.enableServices();googletag.pubads().addEventListener("slotRenderEnded",a._slotRenderEnded)})};this._slotRenderEnded=function(a){a=
c[a.slot.getSlotId().getDomId()].renderCallback;"function"===typeof a&&a()};this._refreshInterval=function(){return n};this.setRefreshInterval=function(a){n=a;return this};this.defineSlot=function(){var a=arguments;a.getSize=function(){return this[1]};a.setRenderCallback=function(a){this.renderCallback=a};c[arguments[2]]=a;return this};this.defineSizeMapping=function(a){e[a]||(e[a]=[]);this.addSize=function(b,c){e[a].push([b,c]);return this};return this};this.setEnabled=function(a){h=a};this.setPageTargeting=
function(a,b){k[a]=b};this.collapseEmptyDivs=function(){l=!0};var b=this;this.$get=["$q","$window","$interval",function(a,f,e){var d=a.defer();b._createTag(function(){b._initialize();null!==b._refreshInterval()&&e(function(){googletag.cmd.push(function(){f.googletag.pubads().refresh()})},b._refreshInterval());d.resolve()});return{getAdSize:function(a){return d.promise.then(function(){if(angular.isUndefined(c[a]))throw"Slot "+a+" has not been defined. Define it using DoubleClickProvider.defineSlot().";
return c[a][1]})},getSlot:function(a){return d.promise.then(function(){if(angular.isUndefined(c[a]))throw"Slot "+a+" has not been defined. Define it using DoubleClickProvider.defineSlot().";return c[a]})},runAd:function(a){googletag.cmd.push(function(){f.googletag.display(a)})},refreshAds:function(){var a=[];angular.forEach(arguments,function(b){a.push(g[b])});googletag.cmd.push(function(){f.googletag.pubads().refresh(a)})},defineSlot:function(a,d,e){return b.defineSlot(a,d,e)},defineSizeMapping:function(a){return b.defineSizeMapping(a)}}}]}]).directive("ngDfpAdContainer",
function(){return{restrict:"A",controller:["$element",function(d){this.$$setVisible=function(c,g){c?"visibility"===g?d.css("visibility","visible"):d.show():"visibility"===g?d.css("visibility","hidden"):d.hide()}}]}}).directive("ngDfpAd",["$timeout","$parse","$interval","DoubleClick",function(d,c,g,e){return{restrict:"A",template:'<div id="{{adId}}"></div>',require:"?^ngDfpAdContainer",scope:{adId:"@ngDfpAd",refresh:"@ngDfpAdRefresh",interval:"@ngDfpAdRefreshInterval",timeout:"@ngDfpAdRefreshTimeout"},
replace:!0,link:function(c,h,k,l){c.$watch("adId",function(b){h.html("");var a=null;e.getSlot(b).then(function(f){var m=f.getSize();h.css("width",m[0]).css("height",m[1]);d(function(){e.runAd(b)});l&&f.setRenderCallback(function(){angular.isDefined(k.ngDfpAdHideWhenEmpty)&&(0===h.find("iframe:not([id*=hidden])").map(function(){return this.contentWindow.document}).find("body").children().length?l.$$setVisible(!1,k.ngDfpAdHideWhenEmpty):l.$$setVisible(!0,k.ngDfpAdHideWhenEmpty))});c.$watch("refresh",
function(a){angular.isUndefined(a)||e.refreshAds(b)});c.$watch("interval",function(d){angular.isUndefined(d)||(g.cancel(a),a=g(function(){e.refreshAds(b)},c.interval))});c.$watch("timeout",function(a){angular.isUndefined(a)||d(function(){e.refreshAds(b)},c.timeout)})})})}}}]);